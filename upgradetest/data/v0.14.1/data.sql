PRAGMA foreign_keys=OFF;
BEGIN TRANSACTION;
CREATE TABLE `_migrations` (file VARCHAR(255) PRIMARY KEY NOT NULL, applied INTEGER NOT NULL);
INSERT INTO _migrations VALUES('1640988000_init.go',1738497345319215);
INSERT INTO _migrations VALUES('1673167670_multi_match_migrate.go',1738497345320464);
INSERT INTO _migrations VALUES('1677152688_rename_authentik_to_oidc.go',1738497345320574);
INSERT INTO _migrations VALUES('1679943780_normalize_single_multiple_values.go',1738497345321631);
INSERT INTO _migrations VALUES('1679943781_add_indexes_column.go',1738497345325987);
INSERT INTO _migrations VALUES('1685164450_check_fk.go',1738497345326078);
INSERT INTO _migrations VALUES('1689579878_renormalize_single_multiple_values.go',1738497345328838);
INSERT INTO _migrations VALUES('1690000000_webhooks.go',1738497345330876);
INSERT INTO _migrations VALUES('1690319366_reset_null_values.go',1738497345332672);
INSERT INTO _migrations VALUES('1690454337_transform_relations_to_views.go',1738497345332750);
INSERT INTO _migrations VALUES('1691747913_resave_views.go',1738497345333357);
INSERT INTO _migrations VALUES('1692609521_copy_display_fields.go',1738497345333523);
INSERT INTO _migrations VALUES('1700000000_base.go',1738497345361832);
INSERT INTO _migrations VALUES('1700000001_collections.go',1738497345377002);
INSERT INTO _migrations VALUES('1700000003_defaultdata.go',1738497345377770);
INSERT INTO _migrations VALUES('1700000004_views.go',1738497345382323);
INSERT INTO _migrations VALUES('1700000005_reactions.go',1738497345385063);
INSERT INTO _migrations VALUES('1700000006_systemuser.go',1738497345387842);
INSERT INTO _migrations VALUES('1700000007_search_view.go',1738497345395386);
INSERT INTO _migrations VALUES('1700000008_dashboardview.go',1738497345399300);
INSERT INTO _migrations VALUES('1700000009_reactions_update.go',1738497345402877);
INSERT INTO _migrations VALUES('1701496825_allow_single_oauth2_provider_in_multiple_auth_collections.go',1738497345402938);
INSERT INTO _migrations VALUES('1702134272_set_default_json_max_size.go',1738497345413023);
INSERT INTO _migrations VALUES('1718706525_add_login_alert_column.go',1738497345413439);
CREATE TABLE `_admins` (
				`id`              TEXT PRIMARY KEY NOT NULL,
				`avatar`          INTEGER DEFAULT 0 NOT NULL,
				`email`           TEXT UNIQUE NOT NULL,
				`tokenKey`        TEXT UNIQUE NOT NULL,
				`passwordHash`    TEXT NOT NULL,
				`lastResetSentAt` TEXT DEFAULT "" NOT NULL,
				`created`         TEXT DEFAULT (strftime('%Y-%m-%d %H:%M:%fZ')) NOT NULL,
				`updated`         TEXT DEFAULT (strftime('%Y-%m-%d %H:%M:%fZ')) NOT NULL
			);
CREATE TABLE `_collections` (
				`id`         TEXT PRIMARY KEY NOT NULL,
				`system`     BOOLEAN DEFAULT FALSE NOT NULL,
				`type`       TEXT DEFAULT "base" NOT NULL,
				`name`       TEXT UNIQUE NOT NULL,
				`schema`     JSON DEFAULT "[]" NOT NULL,
				`indexes`    JSON DEFAULT "[]" NOT NULL,
				`listRule`   TEXT DEFAULT NULL,
				`viewRule`   TEXT DEFAULT NULL,
				`createRule` TEXT DEFAULT NULL,
				`updateRule` TEXT DEFAULT NULL,
				`deleteRule` TEXT DEFAULT NULL,
				`options`    JSON DEFAULT "{}" NOT NULL,
				`created`    TEXT DEFAULT (strftime('%Y-%m-%d %H:%M:%fZ')) NOT NULL,
				`updated`    TEXT DEFAULT (strftime('%Y-%m-%d %H:%M:%fZ')) NOT NULL
			);
INSERT INTO _collections VALUES('_pb_users_auth_',0,'auth','users','[{"system":false,"id":"users_name","name":"name","type":"text","required":false,"presentable":false,"unique":false,"options":{"min":null,"max":null,"pattern":""}},{"system":false,"id":"users_avatar","name":"avatar","type":"file","required":false,"presentable":false,"unique":false,"options":{"mimeTypes":["image/jpeg","image/png","image/svg+xml","image/gif","image/webp"],"thumbs":null,"maxSelect":1,"maxSize":5242880,"protected":false}}]','[]','@request.auth.id != ''''','@request.auth.id != ''''','','id = @request.auth.id','id = @request.auth.id','{"allowEmailAuth":true,"allowOAuth2Auth":true,"allowUsernameAuth":true,"exceptEmailDomains":null,"manageRule":null,"minPasswordLength":8,"onlyEmailDomains":null,"onlyVerified":false,"requireEmail":false}','2025-02-02 11:55:45.310Z','2025-02-02 11:55:45.355Z');
INSERT INTO _collections VALUES('ks77vcbczvc1yrw',1,'base','webhooks','[{"system":false,"id":"g8ihy0al","name":"name","type":"text","required":true,"presentable":false,"unique":false,"options":{"min":null,"max":null,"pattern":""}},{"system":false,"id":"odnju935","name":"collection","type":"text","required":true,"presentable":false,"unique":false,"options":{"min":null,"max":null,"pattern":""}},{"system":false,"id":"icgcxuek","name":"destination","type":"url","required":true,"presentable":false,"unique":false,"options":{"exceptDomains":null,"onlyDomains":null}}]','[]',NULL,NULL,NULL,NULL,NULL,'{}','2025-02-02 11:55:45.328Z','2025-02-02 11:55:45.328Z');
INSERT INTO _collections VALUES('types',0,'base','types','[{"system":false,"id":"j9kdqjz6","name":"singular","type":"text","required":true,"presentable":false,"unique":false,"options":{"min":null,"max":null,"pattern":""}},{"system":false,"id":"mwgq82gk","name":"plural","type":"text","required":true,"presentable":false,"unique":false,"options":{"min":null,"max":null,"pattern":""}},{"system":false,"id":"edle1tfu","name":"icon","type":"text","required":true,"presentable":false,"unique":false,"options":{"min":null,"max":null,"pattern":""}},{"system":false,"id":"cihok0d9","name":"schema","type":"json","required":true,"presentable":false,"unique":false,"options":{"maxSize":2000000}}]','[]','@request.auth.id != ''''','@request.auth.id != ''''','@request.auth.id != ''''','@request.auth.id != ''''','@request.auth.id != ''''','{}','2025-02-02 11:55:45.364Z','2025-02-02 11:55:45.403Z');
INSERT INTO _collections VALUES('tickets',0,'base','tickets','[{"system":false,"id":"fajg9ajv","name":"name","type":"text","required":true,"presentable":false,"unique":false,"options":{"min":null,"max":null,"pattern":""}},{"system":false,"id":"42f7t3er","name":"type","type":"relation","required":false,"presentable":false,"unique":false,"options":{"collectionId":"types","cascadeDelete":false,"minSelect":null,"maxSelect":1,"displayFields":null}},{"system":false,"id":"3bngtgfx","name":"description","type":"text","required":false,"presentable":false,"unique":false,"options":{"min":null,"max":null,"pattern":""}},{"system":false,"id":"rgozirif","name":"open","type":"bool","required":false,"presentable":false,"unique":false,"options":{}},{"system":false,"id":"dd0ijlei","name":"resolution","type":"text","required":false,"presentable":false,"unique":false,"options":{"min":null,"max":null,"pattern":""}},{"system":false,"id":"fsydq5t2","name":"schema","type":"json","required":false,"presentable":false,"unique":false,"options":{"maxSize":2000000}},{"system":false,"id":"qer6qav7","name":"state","type":"json","required":false,"presentable":false,"unique":false,"options":{"maxSize":2000000}},{"system":false,"id":"zuqoc7v9","name":"owner","type":"relation","required":false,"presentable":false,"unique":false,"options":{"collectionId":"_pb_users_auth_","cascadeDelete":false,"minSelect":null,"maxSelect":1,"displayFields":null}}]','[]','@request.auth.id != ''''','@request.auth.id != ''''','@request.auth.id != ''''','@request.auth.id != ''''','@request.auth.id != ''''','{}','2025-02-02 11:55:45.368Z','2025-02-02 11:55:45.403Z');
INSERT INTO _collections VALUES('tasks',0,'base','tasks','[{"system":false,"id":"xdfmerv7","name":"ticket","type":"relation","required":true,"presentable":false,"unique":false,"options":{"collectionId":"tickets","cascadeDelete":true,"minSelect":null,"maxSelect":1,"displayFields":null}},{"system":false,"id":"flx35jnh","name":"name","type":"text","required":true,"presentable":false,"unique":false,"options":{"min":null,"max":null,"pattern":""}},{"system":false,"id":"wbjpk0dn","name":"open","type":"bool","required":false,"presentable":false,"unique":false,"options":{}},{"system":false,"id":"tkfgncth","name":"owner","type":"relation","required":false,"presentable":false,"unique":false,"options":{"collectionId":"_pb_users_auth_","cascadeDelete":false,"minSelect":null,"maxSelect":1,"displayFields":null}}]','[]','@request.auth.id != ''''','@request.auth.id != ''''','@request.auth.id != ''''','@request.auth.id != ''''','@request.auth.id != ''''','{}','2025-02-02 11:55:45.371Z','2025-02-02 11:55:45.371Z');
INSERT INTO _collections VALUES('comments',0,'base','comments','[{"system":false,"id":"zxrfp9g8","name":"ticket","type":"relation","required":true,"presentable":false,"unique":false,"options":{"collectionId":"tickets","cascadeDelete":true,"minSelect":null,"maxSelect":1,"displayFields":null}},{"system":false,"id":"kqb3fsgo","name":"author","type":"relation","required":false,"presentable":false,"unique":false,"options":{"collectionId":"_pb_users_auth_","cascadeDelete":false,"minSelect":null,"maxSelect":1,"displayFields":null}},{"system":false,"id":"ip3u5gft","name":"message","type":"text","required":true,"presentable":false,"unique":false,"options":{"min":null,"max":null,"pattern":""}}]','[]','@request.auth.id != ''''','@request.auth.id != ''''','@request.auth.id != ''''','@request.auth.id != ''''','@request.auth.id != ''''','{}','2025-02-02 11:55:45.372Z','2025-02-02 11:55:45.372Z');
INSERT INTO _collections VALUES('timeline',0,'base','timeline','[{"system":false,"id":"zoqenuzx","name":"ticket","type":"relation","required":true,"presentable":false,"unique":false,"options":{"collectionId":"tickets","cascadeDelete":true,"minSelect":null,"maxSelect":1,"displayFields":null}},{"system":false,"id":"4kxlqidv","name":"time","type":"date","required":true,"presentable":false,"unique":false,"options":{"min":"","max":""}},{"system":false,"id":"lgfatgwm","name":"message","type":"text","required":true,"presentable":false,"unique":false,"options":{"min":null,"max":null,"pattern":""}}]','[]','@request.auth.id != ''''','@request.auth.id != ''''','@request.auth.id != ''''','@request.auth.id != ''''','@request.auth.id != ''''','{}','2025-02-02 11:55:45.373Z','2025-02-02 11:55:45.373Z');
INSERT INTO _collections VALUES('links',0,'base','links','[{"system":false,"id":"rs3oh3gp","name":"ticket","type":"relation","required":true,"presentable":false,"unique":false,"options":{"collectionId":"tickets","cascadeDelete":true,"minSelect":null,"maxSelect":1,"displayFields":null}},{"system":false,"id":"zzrmgg0c","name":"name","type":"text","required":true,"presentable":false,"unique":false,"options":{"min":null,"max":null,"pattern":""}},{"system":false,"id":"sdilea19","name":"url","type":"url","required":true,"presentable":false,"unique":false,"options":{"exceptDomains":null,"onlyDomains":null}}]','[]','@request.auth.id != ''''','@request.auth.id != ''''','@request.auth.id != ''''','@request.auth.id != ''''','@request.auth.id != ''''','{}','2025-02-02 11:55:45.374Z','2025-02-02 11:55:45.374Z');
INSERT INTO _collections VALUES('files',0,'base','files','[{"system":false,"id":"gt0tvwpn","name":"ticket","type":"relation","required":true,"presentable":false,"unique":false,"options":{"collectionId":"tickets","cascadeDelete":true,"minSelect":null,"maxSelect":1,"displayFields":null}},{"system":false,"id":"gmwpjy9o","name":"name","type":"text","required":true,"presentable":false,"unique":false,"options":{"min":null,"max":null,"pattern":""}},{"system":false,"id":"y7m3yqr3","name":"size","type":"number","required":true,"presentable":false,"unique":false,"options":{"min":null,"max":null,"noDecimal":false}},{"system":false,"id":"4zivevpd","name":"blob","type":"file","required":true,"presentable":false,"unique":false,"options":{"mimeTypes":null,"thumbs":null,"maxSelect":1,"maxSize":104857600,"protected":false}}]','[]','@request.auth.id != ''''','@request.auth.id != ''''','@request.auth.id != ''''','@request.auth.id != ''''','@request.auth.id != ''''','{}','2025-02-02 11:55:45.375Z','2025-02-02 11:55:45.375Z');
INSERT INTO _collections VALUES('features',0,'base','features','[{"system":false,"id":"pyomtpqk","name":"name","type":"text","required":true,"presentable":false,"unique":false,"options":{"min":null,"max":null,"pattern":""}}]','["CREATE UNIQUE INDEX `unique_name` ON `features` (`name`)"]','@request.auth.id != ''''','@request.auth.id != ''''',NULL,NULL,NULL,'{}','2025-02-02 11:55:45.376Z','2025-02-02 11:55:45.376Z');
INSERT INTO _collections VALUES('gqf77s1iwg4b21q',0,'view','dashboard_counts','[{"system":false,"id":"je6urwzd","name":"count","type":"json","required":false,"presentable":false,"unique":false,"options":{"maxSize":2000000}}]','[]','@request.auth.id != ''''','@request.auth.id != ''''',NULL,NULL,NULL,'{"query":"SELECT id, count FROM (\n  SELECT ''users'' as id, COUNT(users.id) as count FROM users\n  UNION\n  SELECT ''tickets'' as id, COUNT(tickets.id) as count FROM tickets\n  UNION\n  SELECT ''tasks'' as id, COUNT(tasks.id) as count FROM tasks\n  UNION \n  SELECT ''reactions'' as id, COUNT(reactions.id) as count FROM reactions\n) as counts;"}','2025-02-02 11:55:45.378Z','2025-02-02 11:55:45.404Z');
INSERT INTO _collections VALUES('w3wvvx9r9ed4tos',0,'view','sidebar','[{"system":false,"id":"wboboumx","name":"singular","type":"text","required":true,"presentable":false,"unique":false,"options":{"min":null,"max":null,"pattern":""}},{"system":false,"id":"a7ufovyj","name":"plural","type":"text","required":true,"presentable":false,"unique":false,"options":{"min":null,"max":null,"pattern":""}},{"system":false,"id":"wluuiap1","name":"icon","type":"text","required":true,"presentable":false,"unique":false,"options":{"min":null,"max":null,"pattern":""}},{"system":false,"id":"obv8z3kg","name":"count","type":"json","required":false,"presentable":false,"unique":false,"options":{"maxSize":2000000}}]','[]','@request.auth.id != ''''','@request.auth.id != ''''',NULL,NULL,NULL,'{"query":"SELECT types.id as id, types.singular as singular, types.plural as plural, types.icon as icon, (SELECT COUNT(tickets.id) FROM tickets WHERE tickets.type = types.id AND tickets.open = true) as count\nFROM types\nORDER BY types.plural;"}','2025-02-02 11:55:45.380Z','2025-02-02 11:55:45.405Z');
INSERT INTO _collections VALUES('reactions',0,'base','reactions','[{"system":false,"id":"qcwnobuy","name":"name","type":"text","required":true,"presentable":false,"unique":false,"options":{"min":null,"max":null,"pattern":""}},{"system":false,"id":"virzov3h","name":"trigger","type":"select","required":true,"presentable":false,"unique":false,"options":{"maxSelect":1,"values":["webhook","hook","schedule"]}},{"system":false,"id":"ddmaftde","name":"triggerdata","type":"json","required":true,"presentable":false,"unique":false,"options":{"maxSize":2000000}},{"system":false,"id":"fsqks1xi","name":"action","type":"select","required":true,"presentable":false,"unique":false,"options":{"maxSelect":1,"values":["python","webhook"]}},{"system":false,"id":"r72oeosa","name":"actiondata","type":"json","required":true,"presentable":false,"unique":false,"options":{"maxSize":2000000}}]','[]','@request.auth.id != ''''','@request.auth.id != ''''','@request.auth.id != ''''','@request.auth.id != ''''','@request.auth.id != ''''','{}','2025-02-02 11:55:45.382Z','2025-02-02 11:55:45.406Z');
INSERT INTO _collections VALUES('t8oz0xnwo74hlm5',0,'view','ticket_search','[{"system":false,"id":"fu8pze2u","name":"name","type":"text","required":true,"presentable":false,"unique":false,"options":{"min":null,"max":null,"pattern":""}},{"system":false,"id":"dxoto1xc","name":"description","type":"text","required":false,"presentable":false,"unique":false,"options":{"min":null,"max":null,"pattern":""}},{"system":false,"id":"fyjozvd2","name":"open","type":"bool","required":false,"presentable":false,"unique":false,"options":{}},{"system":false,"id":"4oojfbaj","name":"type","type":"relation","required":false,"presentable":false,"unique":false,"options":{"collectionId":"types","cascadeDelete":false,"minSelect":null,"maxSelect":1,"displayFields":null}},{"system":false,"id":"9fk3v4vn","name":"state","type":"json","required":false,"presentable":false,"unique":false,"options":{"maxSize":2000000}},{"system":false,"id":"ya4xvrsb","name":"owner_name","type":"text","required":false,"presentable":false,"unique":false,"options":{"min":null,"max":null,"pattern":""}},{"system":false,"id":"raudjqro","name":"comment_messages","type":"json","required":false,"presentable":false,"unique":false,"options":{"maxSize":2000000}},{"system":false,"id":"t7wtclnq","name":"file_names","type":"json","required":false,"presentable":false,"unique":false,"options":{"maxSize":2000000}},{"system":false,"id":"at4pqqlm","name":"link_names","type":"json","required":false,"presentable":false,"unique":false,"options":{"maxSize":2000000}},{"system":false,"id":"qxn4zvig","name":"link_urls","type":"json","required":false,"presentable":false,"unique":false,"options":{"maxSize":2000000}},{"system":false,"id":"noceuvlq","name":"task_names","type":"json","required":false,"presentable":false,"unique":false,"options":{"maxSize":2000000}},{"system":false,"id":"1bjnqno0","name":"timeline_messages","type":"json","required":false,"presentable":false,"unique":false,"options":{"maxSize":2000000}}]','[]','@request.auth.id != ''''','@request.auth.id != ''''',NULL,NULL,NULL,'{"query":"\nSELECT \n    tickets.id, \n    tickets.name,\n    tickets.created,\n    tickets.description,\n    tickets.open,\n    tickets.type,\n    tickets.state,\n    users.name as owner_name,\n    group_concat(comments.message) as comment_messages,\n    group_concat(files.name) as file_names,\n    group_concat(links.name) as link_names,\n    group_concat(links.url) as link_urls,\n    group_concat(tasks.name) as task_names,\n    group_concat(timeline.message) as timeline_messages\nFROM tickets\nLEFT JOIN comments ON comments.ticket = tickets.id\nLEFT JOIN files ON files.ticket = tickets.id\nLEFT JOIN links ON links.ticket = tickets.id\nLEFT JOIN tasks ON tasks.ticket = tickets.id\nLEFT JOIN timeline ON timeline.ticket = tickets.id\nLEFT JOIN users ON users.id = tickets.owner\nGROUP BY tickets.id\n"}','2025-02-02 11:55:45.390Z','2025-02-02 11:55:45.410Z');
CREATE TABLE `_params` (
				`id`      TEXT PRIMARY KEY NOT NULL,
				`key`     TEXT UNIQUE NOT NULL,
				`value`   JSON DEFAULT NULL,
				`created` TEXT DEFAULT "" NOT NULL,
				`updated` TEXT DEFAULT "" NOT NULL
			);
INSERT INTO _params VALUES('59gswl2jrzi96ak','settings','{"meta":{"appName":"Catalyst","appUrl":"http://localhost:8090","hideControls":false,"senderName":"Support","senderAddress":"support@example.com","verificationTemplate":{"body":"\u003cp\u003eHello,\u003c/p\u003e\n\u003cp\u003eThank you for joining us at {APP_NAME}.\u003c/p\u003e\n\u003cp\u003eClick on the button below to verify your email address.\u003c/p\u003e\n\u003cp\u003e\n  \u003ca class=\"btn\" href=\"{ACTION_URL}\" target=\"_blank\" rel=\"noopener\"\u003eVerify\u003c/a\u003e\n\u003c/p\u003e\n\u003cp\u003e\n  Thanks,\u003cbr/\u003e\n  {APP_NAME} team\n\u003c/p\u003e","subject":"Verify your {APP_NAME} email","actionUrl":"{APP_URL}/_/#/auth/confirm-verification/{TOKEN}","hidden":false},"resetPasswordTemplate":{"body":"\u003cp\u003eHello,\u003c/p\u003e\n\u003cp\u003eClick on the button below to reset your password.\u003c/p\u003e\n\u003cp\u003e\n  \u003ca class=\"btn\" href=\"{ACTION_URL}\" target=\"_blank\" rel=\"noopener\"\u003eReset password\u003c/a\u003e\n\u003c/p\u003e\n\u003cp\u003e\u003ci\u003eIf you didn''t ask to reset your password, you can ignore this email.\u003c/i\u003e\u003c/p\u003e\n\u003cp\u003e\n  Thanks,\u003cbr/\u003e\n  {APP_NAME} team\n\u003c/p\u003e","subject":"Reset your {APP_NAME} password","actionUrl":"{APP_URL}/_/#/auth/confirm-password-reset/{TOKEN}","hidden":false},"confirmEmailChangeTemplate":{"body":"\u003cp\u003eHello,\u003c/p\u003e\n\u003cp\u003eClick on the button below to confirm your new email address.\u003c/p\u003e\n\u003cp\u003e\n  \u003ca class=\"btn\" href=\"{ACTION_URL}\" target=\"_blank\" rel=\"noopener\"\u003eConfirm new email\u003c/a\u003e\n\u003c/p\u003e\n\u003cp\u003e\u003ci\u003eIf you didn''t ask to change your email address, you can ignore this email.\u003c/i\u003e\u003c/p\u003e\n\u003cp\u003e\n  Thanks,\u003cbr/\u003e\n  {APP_NAME} team\n\u003c/p\u003e","subject":"Confirm your {APP_NAME} new email address","actionUrl":"{APP_URL}/_/#/auth/confirm-email-change/{TOKEN}","hidden":false}},"logs":{"maxDays":5,"minLevel":0,"logIp":true},"smtp":{"enabled":false,"host":"smtp.example.com","port":587,"username":"","password":"","authMethod":"","tls":false,"localName":""},"s3":{"enabled":false,"bucket":"","region":"","endpoint":"","accessKey":"","secret":"","forcePathStyle":false},"backups":{"cron":"","cronMaxKeep":3,"s3":{"enabled":false,"bucket":"","region":"","endpoint":"","accessKey":"","secret":"","forcePathStyle":false}},"adminAuthToken":{"secret":"CcKG6Dc4MkVGtoIjmDGWq1OJUSiVM04EQV9PTNNHIFHKttQ1iH","duration":1209600},"adminPasswordResetToken":{"secret":"fdNGstueOJuVnDTmFQIf8nqtVtSYweZugYpgrpG4ucWwhRKeWY","duration":1800},"adminFileToken":{"secret":"NSSpb58IAkraVx1WibuUVY0d3SX7Z0D8fG6hxxzMJdbEN2uDYG","duration":120},"recordAuthToken":{"secret":"06gTaJUEWagavrHKFVoNGSa6uT0ET5WJBZgrARkf47U0J8Xoe4","duration":1209600},"recordPasswordResetToken":{"secret":"R6AVYhkOQYIAsvUCdM6Tf8E53lfkM8cHcVoAmv19wrx0tiN72r","duration":1800},"recordEmailChangeToken":{"secret":"Q9cbEH6u8TuVDkgld1EId3EDnPOQUYa88o200V0PgzWr1u9BHY","duration":1800},"recordVerificationToken":{"secret":"tLu9Qvd9t94D8GDUCqKIpFktNsyI6Jl1ntkVGHLGVbnFreYmJb","duration":604800},"recordFileToken":{"secret":"PZ8rbxlRugUaDhr3wzTAh1kw7SALsswfVkvnl7aPujSb6FDROi","duration":120},"emailAuth":{"enabled":false,"exceptDomains":null,"onlyDomains":null,"minPasswordLength":0},"googleAuth":{"enabled":false,"clientId":"","clientSecret":"","authUrl":"","tokenUrl":"","userApiUrl":"","displayName":"","pkce":null},"facebookAuth":{"enabled":false,"clientId":"","clientSecret":"","authUrl":"","tokenUrl":"","userApiUrl":"","displayName":"","pkce":null},"githubAuth":{"enabled":false,"clientId":"","clientSecret":"","authUrl":"","tokenUrl":"","userApiUrl":"","displayName":"","pkce":null},"gitlabAuth":{"enabled":false,"clientId":"","clientSecret":"","authUrl":"","tokenUrl":"","userApiUrl":"","displayName":"","pkce":null},"discordAuth":{"enabled":false,"clientId":"","clientSecret":"","authUrl":"","tokenUrl":"","userApiUrl":"","displayName":"","pkce":null},"twitterAuth":{"enabled":false,"clientId":"","clientSecret":"","authUrl":"","tokenUrl":"","userApiUrl":"","displayName":"","pkce":null},"microsoftAuth":{"enabled":false,"clientId":"","clientSecret":"","authUrl":"","tokenUrl":"","userApiUrl":"","displayName":"","pkce":null},"spotifyAuth":{"enabled":false,"clientId":"","clientSecret":"","authUrl":"","tokenUrl":"","userApiUrl":"","displayName":"","pkce":null},"kakaoAuth":{"enabled":false,"clientId":"","clientSecret":"","authUrl":"","tokenUrl":"","userApiUrl":"","displayName":"","pkce":null},"twitchAuth":{"enabled":false,"clientId":"","clientSecret":"","authUrl":"","tokenUrl":"","userApiUrl":"","displayName":"","pkce":null},"stravaAuth":{"enabled":false,"clientId":"","clientSecret":"","authUrl":"","tokenUrl":"","userApiUrl":"","displayName":"","pkce":null},"giteeAuth":{"enabled":false,"clientId":"","clientSecret":"","authUrl":"","tokenUrl":"","userApiUrl":"","displayName":"","pkce":null},"livechatAuth":{"enabled":false,"clientId":"","clientSecret":"","authUrl":"","tokenUrl":"","userApiUrl":"","displayName":"","pkce":null},"giteaAuth":{"enabled":false,"clientId":"","clientSecret":"","authUrl":"","tokenUrl":"","userApiUrl":"","displayName":"","pkce":null},"oidcAuth":{"enabled":false,"clientId":"","clientSecret":"","authUrl":"","tokenUrl":"","userApiUrl":"","displayName":"","pkce":null},"oidc2Auth":{"enabled":false,"clientId":"","clientSecret":"","authUrl":"","tokenUrl":"","userApiUrl":"","displayName":"","pkce":null},"oidc3Auth":{"enabled":false,"clientId":"","clientSecret":"","authUrl":"","tokenUrl":"","userApiUrl":"","displayName":"","pkce":null},"appleAuth":{"enabled":false,"clientId":"","clientSecret":"","authUrl":"","tokenUrl":"","userApiUrl":"","displayName":"","pkce":null},"instagramAuth":{"enabled":false,"clientId":"","clientSecret":"","authUrl":"","tokenUrl":"","userApiUrl":"","displayName":"","pkce":null},"vkAuth":{"enabled":false,"clientId":"","clientSecret":"","authUrl":"","tokenUrl":"","userApiUrl":"","displayName":"","pkce":null},"yandexAuth":{"enabled":false,"clientId":"","clientSecret":"","authUrl":"","tokenUrl":"","userApiUrl":"","displayName":"","pkce":null},"patreonAuth":{"enabled":false,"clientId":"","clientSecret":"","authUrl":"","tokenUrl":"","userApiUrl":"","displayName":"","pkce":null},"mailcowAuth":{"enabled":false,"clientId":"","clientSecret":"","authUrl":"","tokenUrl":"","userApiUrl":"","displayName":"","pkce":null},"bitbucketAuth":{"enabled":false,"clientId":"","clientSecret":"","authUrl":"","tokenUrl":"","userApiUrl":"","displayName":"","pkce":null},"planningcenterAuth":{"enabled":false,"clientId":"","clientSecret":"","authUrl":"","tokenUrl":"","userApiUrl":"","displayName":"","pkce":null}}','2025-02-02 11:55:45.267Z','2025-02-02 11:55:45.333Z');
CREATE TABLE `_externalAuths` (
				`id`           TEXT PRIMARY KEY NOT NULL,
				`collectionId` TEXT NOT NULL,
				`recordId`     TEXT NOT NULL,
				`provider`     TEXT NOT NULL,
				`providerId`   TEXT NOT NULL,
				`created`      TEXT DEFAULT (strftime('%Y-%m-%d %H:%M:%fZ')) NOT NULL,
				`updated`      TEXT DEFAULT (strftime('%Y-%m-%d %H:%M:%fZ')) NOT NULL,
				---
				FOREIGN KEY (`collectionId`) REFERENCES `_collections` (`id`) ON UPDATE CASCADE ON DELETE CASCADE
			);
CREATE TABLE `users` (`avatar` TEXT DEFAULT '' NOT NULL, `created` TEXT DEFAULT (strftime('%Y-%m-%d %H:%M:%fZ')) NOT NULL, `email` TEXT DEFAULT '' NOT NULL, `emailVisibility` BOOLEAN DEFAULT FALSE NOT NULL, `id` TEXT PRIMARY KEY DEFAULT ('r'||lower(hex(randomblob(7)))) NOT NULL, `lastLoginAlertSentAt` TEXT DEFAULT '' NOT NULL, `lastResetSentAt` TEXT DEFAULT '' NOT NULL, `lastVerificationSentAt` TEXT DEFAULT '' NOT NULL, `name` TEXT DEFAULT '' NOT NULL, `passwordHash` TEXT NOT NULL, `tokenKey` TEXT NOT NULL, `updated` TEXT DEFAULT (strftime('%Y-%m-%d %H:%M:%fZ')) NOT NULL, `username` TEXT NOT NULL, `verified` BOOLEAN DEFAULT FALSE NOT NULL);
INSERT INTO users VALUES('','2025-02-02 11:55:45.385Z','',0,'system','','','','system','','','2025-02-02 11:55:45.385Z','system',1);
INSERT INTO users VALUES('','2025-02-02 11:55:45.680Z','user@catalyst-soar.com',0,'u_test','','','','Test User','$2a$12$jJm.eY2y2gHbAzK80KmK/eU4Ps7uwpA4AwFjTkDaHYZKcxoHIh/ee','34S1pQZfK4qRQ5WXiSeO3KkqvaUrgGOzQPH6BhV55ZhBdsQbsG','2025-02-02 11:55:45.680Z','u_test',1);
CREATE TABLE `webhooks` (`collection` TEXT DEFAULT '' NOT NULL, `created` TEXT DEFAULT (strftime('%Y-%m-%d %H:%M:%fZ')) NOT NULL, `destination` TEXT DEFAULT '' NOT NULL, `id` TEXT PRIMARY KEY DEFAULT ('r'||lower(hex(randomblob(7)))) NOT NULL, `name` TEXT DEFAULT '' NOT NULL, `updated` TEXT DEFAULT (strftime('%Y-%m-%d %H:%M:%fZ')) NOT NULL);
CREATE TABLE `types` (`created` TEXT DEFAULT (strftime('%Y-%m-%d %H:%M:%fZ')) NOT NULL, `icon` TEXT DEFAULT '' NOT NULL, `id` TEXT PRIMARY KEY DEFAULT ('r'||lower(hex(randomblob(7)))) NOT NULL, `plural` TEXT DEFAULT '' NOT NULL, `schema` JSON DEFAULT NULL, `singular` TEXT DEFAULT '' NOT NULL, `updated` TEXT DEFAULT (strftime('%Y-%m-%d %H:%M:%fZ')) NOT NULL);
INSERT INTO types VALUES('2025-02-02 11:55:45.377Z','Flame','incident','Incidents','{"properties":{"severity":{"enum":["Low","Medium","High"],"title":"Severity"}},"required":["severity"],"type":"object"}','Incident','2025-02-02 11:55:45.377Z');
INSERT INTO types VALUES('2025-02-02 11:55:45.377Z','AlertTriangle','alert','Alerts','{"properties":{"severity":{"enum":["Low","Medium","High"],"title":"Severity"}},"required":["severity"],"type":"object"}','Alert','2025-02-02 11:55:45.377Z');
CREATE TABLE `tickets` (`created` TEXT DEFAULT (strftime('%Y-%m-%d %H:%M:%fZ')) NOT NULL, `description` TEXT DEFAULT '' NOT NULL, `id` TEXT PRIMARY KEY DEFAULT ('r'||lower(hex(randomblob(7)))) NOT NULL, `name` TEXT DEFAULT '' NOT NULL, `open` BOOLEAN DEFAULT FALSE NOT NULL, `owner` TEXT DEFAULT '' NOT NULL, `resolution` TEXT DEFAULT '' NOT NULL, `schema` JSON DEFAULT NULL, `state` JSON DEFAULT NULL, `type` TEXT DEFAULT '' NOT NULL, `updated` TEXT DEFAULT (strftime('%Y-%m-%d %H:%M:%fZ')) NOT NULL);
INSERT INTO tickets VALUES('2025-02-01 11:29:35.000Z','Phishing email reported by several employees.','t_0','phishing-123',1,'u_test','','{"type":"object","properties":{"tlp":{"title":"TLP","type":"string"}}}','{"severity":"Medium"}','alert','2025-02-01 11:34:35.000Z');
CREATE TABLE `tasks` (`created` TEXT DEFAULT (strftime('%Y-%m-%d %H:%M:%fZ')) NOT NULL, `id` TEXT PRIMARY KEY DEFAULT ('r'||lower(hex(randomblob(7)))) NOT NULL, `name` TEXT DEFAULT '' NOT NULL, `open` BOOLEAN DEFAULT FALSE NOT NULL, `owner` TEXT DEFAULT '' NOT NULL, `ticket` TEXT DEFAULT '' NOT NULL, `updated` TEXT DEFAULT (strftime('%Y-%m-%d %H:%M:%fZ')) NOT NULL);
INSERT INTO tasks VALUES('2025-02-01 11:49:35.000Z','ts_0','This is a test task.',1,'u_test','t_0','2025-02-01 11:54:35.000Z');
CREATE TABLE `comments` (`author` TEXT DEFAULT '' NOT NULL, `created` TEXT DEFAULT (strftime('%Y-%m-%d %H:%M:%fZ')) NOT NULL, `id` TEXT PRIMARY KEY DEFAULT ('r'||lower(hex(randomblob(7)))) NOT NULL, `message` TEXT DEFAULT '' NOT NULL, `ticket` TEXT DEFAULT '' NOT NULL, `updated` TEXT DEFAULT (strftime('%Y-%m-%d %H:%M:%fZ')) NOT NULL);
INSERT INTO comments VALUES('u_test','2025-02-01 11:39:35.000Z','c_0','This is a test comment.','t_0','2025-02-01 11:44:35.000Z');
CREATE TABLE `timeline` (`created` TEXT DEFAULT (strftime('%Y-%m-%d %H:%M:%fZ')) NOT NULL, `id` TEXT PRIMARY KEY DEFAULT ('r'||lower(hex(randomblob(7)))) NOT NULL, `message` TEXT DEFAULT '' NOT NULL, `ticket` TEXT DEFAULT '' NOT NULL, `time` TEXT DEFAULT '' NOT NULL, `updated` TEXT DEFAULT (strftime('%Y-%m-%d %H:%M:%fZ')) NOT NULL);
INSERT INTO timeline VALUES('2025-02-01 11:44:35.000Z','tl_0','This is a test timeline message.','t_0','2025-02-01 11:44:35.000Z','2025-02-01 11:49:35.000Z');
CREATE TABLE `links` (`created` TEXT DEFAULT (strftime('%Y-%m-%d %H:%M:%fZ')) NOT NULL, `id` TEXT PRIMARY KEY DEFAULT ('r'||lower(hex(randomblob(7)))) NOT NULL, `name` TEXT DEFAULT '' NOT NULL, `ticket` TEXT DEFAULT '' NOT NULL, `updated` TEXT DEFAULT (strftime('%Y-%m-%d %H:%M:%fZ')) NOT NULL, `url` TEXT DEFAULT '' NOT NULL);
INSERT INTO links VALUES('2025-02-01 11:54:35.000Z','l_0','This is a test link.','t_0','2025-02-01 11:59:35.000Z','https://www.example.com');
CREATE TABLE `files` (`blob` TEXT DEFAULT '' NOT NULL, `created` TEXT DEFAULT (strftime('%Y-%m-%d %H:%M:%fZ')) NOT NULL, `id` TEXT PRIMARY KEY DEFAULT ('r'||lower(hex(randomblob(7)))) NOT NULL, `name` TEXT DEFAULT '' NOT NULL, `size` NUMERIC DEFAULT 0 NOT NULL, `ticket` TEXT DEFAULT '' NOT NULL, `updated` TEXT DEFAULT (strftime('%Y-%m-%d %H:%M:%fZ')) NOT NULL);
CREATE TABLE `features` (`created` TEXT DEFAULT (strftime('%Y-%m-%d %H:%M:%fZ')) NOT NULL, `id` TEXT PRIMARY KEY DEFAULT ('r'||lower(hex(randomblob(7)))) NOT NULL, `name` TEXT DEFAULT '' NOT NULL, `updated` TEXT DEFAULT (strftime('%Y-%m-%d %H:%M:%fZ')) NOT NULL);
CREATE TABLE `reactions` (`action` TEXT DEFAULT '' NOT NULL, `actiondata` JSON DEFAULT NULL, `created` TEXT DEFAULT (strftime('%Y-%m-%d %H:%M:%fZ')) NOT NULL, `id` TEXT PRIMARY KEY DEFAULT ('r'||lower(hex(randomblob(7)))) NOT NULL, `name` TEXT DEFAULT '' NOT NULL, `trigger` TEXT DEFAULT '' NOT NULL, `triggerdata` JSON DEFAULT NULL, `updated` TEXT DEFAULT (strftime('%Y-%m-%d %H:%M:%fZ')) NOT NULL);
INSERT INTO reactions VALUES('python','{"requirements":"pocketbase","script":"import sys\nimport json\nimport random\nimport os\n\nfrom pocketbase import PocketBase\n\n# Connect to the PocketBase server\nclient = PocketBase(os.environ[\"CATALYST_APP_URL\"])\nclient.auth_store.save(token=os.environ[\"CATALYST_TOKEN\"])\n\nnewtickets = client.collection(\"tickets\").get_list(1, 200, {\"filter\": ''name = \"New Ticket\"''})\nfor ticket in newtickets.items:\n\tclient.collection(\"tickets\").delete(ticket.id)\n\n# Create a new ticket\nclient.collection(\"tickets\").create({\n\t\"name\": \"New Ticket\",\n\t\"type\": \"alert\",\n\t\"open\": True,\n})"}','2025-02-01 11:30:00.000Z','w_0','Create New Ticket','schedule','{"expression":"12 * * * *"}','2025-02-01 11:35:00.000Z');
CREATE UNIQUE INDEX _externalAuths_record_provider_idx on `_externalAuths` (`collectionId`, `recordId`, `provider`);
CREATE UNIQUE INDEX _externalAuths_collection_provider_idx on `_externalAuths` (`collectionId`, `provider`, `providerId`);
CREATE UNIQUE INDEX __pb_users_auth__username_idx ON `users` (`username`);
CREATE UNIQUE INDEX __pb_users_auth__email_idx ON `users` (`email`) WHERE `email` != '';
CREATE UNIQUE INDEX __pb_users_auth__tokenKey_idx ON `users` (`tokenKey`);
CREATE UNIQUE INDEX `unique_name` ON `features` (`name`);
CREATE VIEW `sidebar` AS SELECT * FROM (SELECT types.id as id, types.singular as singular, types.plural as plural, types.icon as icon, (SELECT COUNT(tickets.id) FROM tickets WHERE tickets.type = types.id AND tickets.open = true) as count
FROM types
ORDER BY types.plural);
CREATE VIEW `ticket_search` AS SELECT * FROM (SELECT 
    tickets.id, 
    tickets.name,
    tickets.created,
    tickets.description,
    tickets.open,
    tickets.type,
    tickets.state,
    users.name as owner_name,
    group_concat(comments.message) as comment_messages,
    group_concat(files.name) as file_names,
    group_concat(links.name) as link_names,
    group_concat(links.url) as link_urls,
    group_concat(tasks.name) as task_names,
    group_concat(timeline.message) as timeline_messages
FROM tickets
LEFT JOIN comments ON comments.ticket = tickets.id
LEFT JOIN files ON files.ticket = tickets.id
LEFT JOIN links ON links.ticket = tickets.id
LEFT JOIN tasks ON tasks.ticket = tickets.id
LEFT JOIN timeline ON timeline.ticket = tickets.id
LEFT JOIN users ON users.id = tickets.owner
GROUP BY tickets.id);
CREATE VIEW `dashboard_counts` AS SELECT * FROM (SELECT cast(`id` as text) `id`,`count` FROM (SELECT id, count FROM (
  SELECT 'users' as id, COUNT(users.id) as count FROM users
  UNION
  SELECT 'tickets' as id, COUNT(tickets.id) as count FROM tickets
  UNION
  SELECT 'tasks' as id, COUNT(tasks.id) as count FROM tasks
  UNION 
  SELECT 'reactions' as id, COUNT(reactions.id) as count FROM reactions
) as counts));
COMMIT;
